<h1>ショッピングカート</h1>

<%= link_to "カートを空にする", '/cart_items/destroy_all', method: :delete, :class => "btn btn-danger" %>

<% @cart_items.each do |cart_item| %>
  <div>
    <p>商品名：
      <%= image_tag cart_item.item.get_image %>
      <%= cart_item.item.name %>
    </p>
    <p>単価（税込）：<%= cart_item.item.with_tax_price.to_s(:dalimited) %></p>
    <div>
    <p>数量：<%= cart_item.amount %></p>
      <%= form_with model: cart_item, url:cart_item_path(cart_item.id) do |f| %>
        <%= f.select :amount, *[1..10], {selected: 'cart_item.amount' } %>
        <%= f.submit "変更", :class => "btn btn-success" %>
      <% end %>
      <!--<#%= link_to '変更', cart_item_path, :class => "btn btn-success" %>-->
    </div>
    <p>小計：<%= cart_item.subtotal %></p>
    <%= link_to "削除", cart_item_path(cart_item.id), method: :delete, :class => "btn btn-danger" %>
  </div>
  <% @total += cart_item.subtotal %>
<% end %>
   <p>合計：
      <%= @total %>
   </p>
